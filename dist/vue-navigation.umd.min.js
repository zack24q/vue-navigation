/**
* vue-navigation v1.0.0-beta.3
* https://github.com/zack24q/vue-navigation
* Released under the MIT License.
*/
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):t.VueNavigation=n()}(this,function(){"use strict";function t(){return"xxxxxxxx".replace(/[xy]/g,function(t){var n=16*Math.random()|0;return("x"===t?n:3&n|8).toString(16)})}function n(t,n){return(t.name||t.path)+"?"+t.query[n]}function e(t,n){return Array.isArray(t)?t.indexOf(n)>-1:"string"==typeof t?t.split(",").indexOf(n)>-1:!!isRegExp(t)&&t.test(n)}var o=[];window.sessionStorage.VUE_NAVIGATION&&(o=JSON.parse(window.sessionStorage.VUE_NAVIGATION));var r=o,i=function(t,e,o,i){e&&e.registerModule(o,{state:{routes:r},mutations:{"navigation/FORWARD":function(t,n){n.to,n.from;var e=n.name;t.routes.push(e)},"navigation/BACK":function(t,n){n.to,n.from;var e=n.count;t.routes.splice(t.routes.length-e,e)},"navigation/REFRESH":function(t,n){n.to,n.from},"navigation/RESET":function(t){t.routes.splice(0,t.routes.length)}}});var a=function(n,i,a){var s={route:i},c={route:a},u=e?e.state[o].routes:r;c.name=u[u.length-1]||null,s.name=n,e?e.commit("navigation/FORWARD",{to:s,from:c,name:n}):u.push(n),window.sessionStorage.VUE_NAVIGATION=JSON.stringify(u),t.$emit("forward",s,c)},s=function(n,i,a){var s={route:i},c={route:a},u=e?e.state[o].routes:r;c.name=u[u.length-1],s.name=u[u.length-1-n],e?e.commit("navigation/BACK",{to:s,from:c,count:n}):u.splice(r.length-n,n),window.sessionStorage.VUE_NAVIGATION=JSON.stringify(u),t.$emit("back",s,c)},c=function(n,i){var a={route:n},s={route:i},c=e?e.state[o].routes:r;a.name=s.name=c[c.length-1],e&&e.commit("navigation/REFRESH",{to:a,from:s}),t.$emit("refresh",a,s)};return{record:function(t,e){var o=n(t,i),u=r.lastIndexOf(o);-1===u?a(o,t,e):u===r.length-1?c(t,e):s(r.length-1-u,t,e)},reset:function(){e?e.commit("navigation/RESET"):r.splice(0,r.length),window.sessionStorage.VUE_NAVIGATION=JSON.stringify([]),t.$emit("reset")}}},a=function(t){return{name:"navigation",abstract:!0,props:{},data:function(){return{routes:r}},computed:{},watch:{routes:function(t){for(var n in this.cache)if(!e(t,n)){var o=this.cache[n];o&&o.componentInstance.$destroy(),delete this.cache[n]}}},created:function(){this.cache={}},destroyed:function(){for(var t in this.cache){var n=this.cache[t];n&&n.componentInstance.$destroy()}},render:function(){var e=this.$slots.default?this.$slots.default[0]:null;if(e){var o=n(this.$route,t);e.key+=o,this.cache[o]?e.componentInstance=this.cache[o].componentInstance:this.cache[o]=e,e.data.keepAlive=!0}return e}}},s=Object.assign||function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t};return{install:function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=e.router,c=e.store,u=e.moduleName,f=void 0===u?"navigation":u,h=e.keyName,l=void 0===h?"VNK":h;if(o){var g=new n,m=i(g,c,f,l);o.beforeEach(function(n,e,o){if(n.query[l])o();else{var r=s({},n.query);r[l]=t(),o({path:n.path,query:r,replace:!e.query[l]})}}),o.afterEach(function(t,n){m.record(t,n)}),n.component("navigation",a(l)),n.navigation=n.prototype.$navigation={on:function(t,n){g.$on(t,n)},once:function(t,n){g.$once(t,n)},off:function(t,n){g.$off(t,n)},getRoutes:function(){return r.slice()},cleanRoutes:function(){return m.reset()}}}else console.error("vue-navigation need options: router")}}});